---
title: "R-Shiny Dataset Transformation"
#output: html_notebook
---


Importing the libraries I will need and the data I will be manipulating
```{r}
library(dplyr)
library(jsonlite)
```
```{r}
data = read.csv('data\\US_youtube_trending_data.csv', header=TRUE, )
categories_data = fromJSON('data\\US_category_id.json', flatten=TRUE)
```

Creating a dataframe with the text version of the categories information for my use.
```{r}
categories_df = data.frame(categories_data$items)
categories_df = categories_df %>% select(number=id, category_text=snippet.title)
categories_df$number = as.integer(categories_df$number)
```
Combine this category text with my original dataframe

```{r}
data
```


```{r}
data = data %>% merge(categories_df, by.x='categoryId', by.y='number') %>% arrange(trending_date)
```
I have only changed one data field, and there are many to go still.


Convert the published and trending datetimes to actual datetimes from characters. 
```{r}
data$publishedAt = data$publishedAt %>% strptime('%Y-%m-%dT%H:%M:%S', tz='UTC')
data$trending_date = data$trending_date %>% strptime('%Y-%m-%dT%H:%M:%S', tz='UTC')
```

Add a column that stores the time between publish and the trending record date.
```{r}
data = data %>% mutate(publish_to_trending_days = round(ifelse((trending_date - publishedAt)>0,difftime(trending_date, publishedAt, units='days'),as.difftime(0,units='days')),2))
```
Rearrange my columns and get rid of a few I won't use at all (categoryId, thumbnail_link, description):
```{r}
data = data %>% select(video_id, title, channelId, channelTitle, publishedAt, trending_date, publish_to_trending_days, category_text, tags, view_count, likes, dislikes, comment_count, comments_disabled, ratings_disabled)
```

26 strange records with 0 views, loooks like google-promoted content that shouldn't really be on the list.
```{r}
data = data %>% filter(view_count!=0)
```

Convert the ratings_disabled and comments_disabled into boolean values.
```{r}
# First, check the only character values are True and False
unique(data$comments_disabled)
unique(data$ratings_disabled)

```
```{r}
# Now convert the columns
data$comments_disabled = as.logical(data$comments_disabled)
data$ratings_disabled = as.logical(data$ratings_disabled)
```




save my data as my working dataset.
```{r}
write.csv(data, 'data\\Youtube_Working_Dataset.csv', row.names=FALSE)
```






